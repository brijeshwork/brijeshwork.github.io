<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CI/CD Pipeline Design | Blue/Green, Canary & GitOps</title>
  <meta name="description"
    content="Architecting resilient CI/CD pipelines: Deployment strategies (Blue/Green, Canary), Testing Pyramid, Immutable Infrastructure, and GitOps workflows.">
  <meta name="keywords"
    content="system design, cicd, pipeline, blue green deployment, canary release, gitops, argocd, jenkins, github actions, immutable infrastructure">
  <meta name="author" content="Brijesh Patel">
  <link rel="canonical" href="https://brijesh.work/system-design/cicd-pipeline-design/" />

  <!-- Styles -->
  <link rel="stylesheet" href="https://brijesh.work/pub/css/bootstrap.css">
  <link rel="stylesheet" href="https://brijesh.work/pub/css/style-main.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://brijesh.work/pub/js/global.js" crossorigin="anonymous"></script>

  <style>
    /* Shared System Design Theme */
    .hero-section {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      /* Slate/Blue */
      color: white;
      padding: 4rem 0;
      margin-bottom: 2rem;
      border-bottom: 4px solid #38bdf8;
      /* Sky Blue accent */
    }

    .hero-subtitle {
      color: #bae6fd;
      font-size: 1.25rem;
    }

    .sidebar-sticky {
      position: sticky;
      top: 2rem;
    }

    .sidebar-toc .nav-link {
      color: #64748b;
      padding: 0.25rem 0;
      font-size: 0.95rem;
    }

    .sidebar-toc .nav-link:hover,
    .sidebar-toc .nav-link.active {
      color: #0ea5e9;
      font-weight: 500;
    }

    .content-section {
      margin-bottom: 3rem;
    }

    .tech-card {
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      padding: 1.5rem;
      height: 100%;
      background: #f1f5f9;
      /* Light slate */
      transition: transform 0.2s;
    }

    .tech-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .comparison-table th {
      background-color: #f0f9ff;
    }

    .badge-soft {
      background-color: rgba(56, 189, 248, 0.1);
      color: #0284c7;
      padding: 0.5em 0.8em;
    }

    .pipeline-viz {
      background: #ffffff;
      border: 2px dashed #0ea5e9;
      border-radius: 0.5rem;
      padding: 2rem;
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .stage-box {
      border: 2px solid #0f172a;
      padding: 10px 15px;
      display: inline-block;
      margin: 10px;
      background: #fff;
      border-radius: 8px;
      font-weight: bold;
      color: #1e293b;
    }

    .arrow {
      font-size: 1.5rem;
      color: #38bdf8;
      vertical-align: middle;
      margin: 0 10px;
    }

    @media (max-width: 991px) {
      .order-lg-1 {
        order: 2;
      }

      .order-lg-2 {
        order: 1;
      }
    }
  </style>
</head>

<body class="bg-white">

  <header loadhtml="https://brijesh.work/pub/inc/header.html" class="header border-bottom"></header>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <div class="row">
        <div class="col-lg-8">
          <span
            class="badge badge-soft mb-3 rounded-pill bg-light bg-opacity-10 text-white border border-white border-opacity-25">DevOps
            & Automation</span>
          <h1 class="display-4 fw-bold mb-3">CI/CD Pipeline Design</h1>
          <p class="hero-subtitle mb-4">Shipping code largely, safely, and quickly: Anatomy of a Pipeline, Deployment
            Strategies (Blue/Green, Canary), and Immutable Infrastructure.</p>
          <div class="d-flex gap-3">
            <a href="#strategies" class="btn btn-light text-primary fw-bold"
              style="color: #0f172a !important;">Deployment Strategies</a>
            <a href="#pipeline" class="btn btn-outline-light">Pipeline Flow</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="container pb-5">
    <div class="row">

      <!-- Main Content -->
      <main class="col-lg-9 order-lg-2">

        <!-- Architecture -->
        <section id="pipeline" class="content-section">
          <h2>The Release Pipeline</h2>
          <p class="lead text-secondary">A pipeline transforms code into a running service. It must be
            <strong>Idempotent</strong> and <strong>Immutable</strong>.</p>

          <div class="pipeline-viz d-none d-md-block">
            <div class="stage-box">Code<br>(Git Push)</div>
            <span class="arrow">â†’</span>
            <div class="stage-box bg-light">Build<br>(Docker Build)</div>
            <span class="arrow">â†’</span>
            <div class="stage-box bg-warning text-dark">Test<br>(Unit/Integration)</div>
            <span class="arrow">â†’</span>
            <div class="stage-box bg-light">Release<br>(Push to Registry)</div>
            <span class="arrow">â†’</span>
            <div class="stage-box bg-success text-white">Deploy<br>(K8s Apply)</div>
          </div>
        </section>

        <!-- Testing Pyramid -->
        <section id="testing" class="content-section">
          <h2>The Testing Pyramid</h2>
          <p>Don't just run E2E tests. They are slow and flaky. Balance your suite.</p>
          <div class="row text-center">
            <div class="col-md-4">
              <div class="p-3 bg-danger text-white rounded mb-2">E2E (UI) <br><small>10% (Slow)</small></div>
            </div>
            <div class="col-md-4">
              <div class="p-3 bg-warning text-dark rounded mb-2">Integration (API) <br><small>20% (Medium)</small></div>
            </div>
            <div class="col-md-4">
              <div class="p-3 bg-success text-white rounded mb-2">Unit (Code) <br><small>70% (Fast)</small></div>
            </div>
          </div>
        </section>

        <!-- Deployment Strategies -->
        <section id="strategies" class="content-section">
          <h2>Deployment Strategies</h2>
          <p>How do you update a running application without downtime?</p>

          <table class="table table-bordered comparison-table">
            <thead>
              <tr>
                <th>Strategy</th>
                <th>Description</th>
                <th>Pros</th>
                <th>Cons</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Rolling Update</strong></td>
                <td>Replace N instances at a time (e.g., k8s default).</td>
                <td>Zero downtime. No extra infrastructure cost.</td>
                <td>Slow rollback. Hard to verify mid-flight.</td>
              </tr>
              <tr>
                <td><strong>Blue/Green</strong></td>
                <td>Spin up a full parallel environment (Green). Switch load balancer.</td>
                <td>Instant rollback (Switch back to Blue). Safe.</td>
                <td>Double infrastructure cost (2x resources).</td>
              </tr>
              <tr>
                <td><strong>Canary</strong></td>
                <td>Route 1% of traffic to new version. Gradually increase.</td>
                <td>Real user testing. Lowest risk of widespread outage.</td>
                <td>Complex routing (requires Service Mesh/LB).</td>
              </tr>
            </tbody>
          </table>
        </section>

        <!-- Immutable Infra -->
        <section id="immutable" class="content-section">
          <h2>Immutable Infrastructure</h2>
          <div class="row">
            <div class="col-md-6 mb-3">
              <div class="tech-card">
                <h5 class="fw-bold">ðŸš« Mutable (Bad)</h5>
                <p class="small text-muted">SSH into servers to run `git pull` or `apt-get install`. Leads to
                  "Configuration Drift" and "Snowflake Servers".</p>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="tech-card">
                <h5 class="fw-bold">âœ… Immutable (Good)</h5>
                <p class="small text-muted">Bake a new Docker Image or AMI for every change. Never patch running
                  servers. If a server is sick, shoot it and spawn a new one.</p>
              </div>
            </div>
          </div>

          <h5 class="mt-4">Example: GitHub Actions Workflow</h5>
          <pre><code class="language-yaml">name: Production Build
on:
  push:
    tags: ["v*"]

jobs:
  build-and-push:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Build Docker Image
        run: docker build -t myapp:${{ github.ref_name }} .
      - name: Push to Registry
        run: docker push myregistry.com/myapp:${{ github.ref_name }}
      - name: Deploy to K8s
        run: |
          # GitOps Pattern: Update the manifest repo, don't kubectl apply directly
          git clone git@github.com:org/ops-repo.git
          cd ops-repo
          yq -i '.spec.template.spec.containers[0].image = "myapp:${{ github.ref_name }}"' deployment.yaml
          git commit -am "Deploy v${{ github.ref_name }}"
          git push</code></pre>
        </section>

        <section class="content-section border-top pt-5">
          <h2>Summary</h2>
          <ul>
            <li><strong>Automate Everything:</strong> Humans should not touch production servers.</li>
            <li><strong>Fail Fast:</strong> Run unit tests first. If they fail, stop the pipeline immediately.</li>
            <li><strong>GitOps:</strong> The state of your cluster should mirror the state of your Git repository.</li>
          </ul>
        </section>

      </main>

      <!-- Sidebar -->
      <aside class="col-lg-3 order-lg-1 mb-4">
        <div class="sidebar-sticky">
          <h6 class="fw-bold text-uppercase text-secondary mb-3 small tracking-wide">On this page</h6>
          <nav class="nav flex-column sidebar-toc">
            <a class="nav-link" href="#pipeline">Pipeline Flow</a>
            <a class="nav-link" href="#testing">Testing Pyramid</a>
            <a class="nav-link" href="#strategies">Deployment Strategies</a>
            <a class="nav-link" href="#immutable">Immutable Infra</a>
          </nav>

          <hr class="my-4">
          <h6 class="fw-bold text-secondary mb-3 small">Related Topics</h6>
          <ul class="list-unstyled small">
            <li class="mb-2"><a href="../containerized-docker-kubernetes/"
                class="text-decoration-none text-muted">Docker & K8s</a></li>
            <li class="mb-2"><a href="../database-migrations/" class="text-decoration-none text-muted">DB Migrations</a>
            </li>
            <li class="mb-2"><a href="../logging-monitoring/" class="text-decoration-none text-muted">Observability</a>
            </li>
          </ul>
        </div>
      </aside>

    </div>
  </div>

  <footer loadhtml="https://brijesh.work/pub/inc/footer.html"></footer>
  <script src="https://brijesh.work/pub/js/footer.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
  <script>includeHTML();</script>
</body>

</html>