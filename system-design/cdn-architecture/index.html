<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CDN System Design | Caching, Anycast DNS & Edge Routing</title>
  <meta name="description"
    content="In-depth guide to Content Delivery Network (CDN) architecture: Push vs Pull caching, Anycast routing, Cache Eviction policies (LRU/LFU), and Edge Server design.">
  <meta name="keywords"
    content="system design, cdn architecture, caching strategies, push vs pull cdn, anycast dns, geo-routing, cache eviction, edge servers, nginx caching">
  <meta name="author" content="Brijesh Patel">
  <link rel="canonical" href="https://brijesh.work/system-design/cdn-architecture/" />

  <!-- Styles -->
  <link rel="stylesheet" href="https://brijesh.work/pub/css/bootstrap.css">
  <link rel="stylesheet" href="https://brijesh.work/pub/css/style-main.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://brijesh.work/pub/js/global.js" crossorigin="anonymous"></script>

  <style>
    /* Shared System Design Theme */
    .hero-section {
      background: linear-gradient(135deg, #ea580c 0%, #c2410c 100%);
      color: white;
      padding: 4rem 0;
      margin-bottom: 2rem;
    }

    .hero-subtitle {
      color: #ffedd5;
      font-size: 1.25rem;
    }

    .sidebar-sticky {
      position: sticky;
      top: 2rem;
    }

    .sidebar-toc .nav-link {
      color: #64748b;
      padding: 0.25rem 0;
      font-size: 0.95rem;
    }

    .sidebar-toc .nav-link:hover,
    .sidebar-toc .nav-link.active {
      color: #c2410c;
      font-weight: 500;
    }

    .content-section {
      margin-bottom: 3rem;
    }

    .tech-card {
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      padding: 1.5rem;
      height: 100%;
      background: #f8fafc;
      transition: transform 0.2s;
    }

    .tech-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .comparison-table th {
      background-color: #fff7ed;
    }

    .badge-soft {
      background-color: rgba(234, 88, 12, 0.1);
      color: #c2410c;
      padding: 0.5em 0.8em;
    }

    .geo-diagram {
      background: #ffffff;
      border: 2px dashed #fb923c;
      border-radius: 0.5rem;
      padding: 2rem;
      text-align: center;
      margin-bottom: 1.5rem;
      font-family: monospace;
    }

    .geo-box {
      border: 2px solid #94a3b8;
      padding: 10px 15px;
      display: inline-block;
      margin: 10px;
      background: #fff;
      border-radius: 50%;
      /* Circle for Point of Presence */
      width: 100px;
      height: 100px;
      vertical-align: top;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .origin-box {
      border: 3px solid #000;
      background: #e5e5e5;
      border-radius: 8px;
      width: 120px;
      height: 80px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .arrow {
      font-size: 1.5rem;
      color: #f97316;
      vertical-align: middle;
      margin: 0 10px;
    }

    @media (max-width: 991px) {
      .order-lg-1 {
        order: 2;
      }

      .order-lg-2 {
        order: 1;
      }
    }
  </style>
</head>

<body class="bg-white">

  <header loadhtml="https://brijesh.work/pub/inc/header.html" class="header border-bottom"></header>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <div class="row">
        <div class="col-lg-8">
          <span
            class="badge badge-soft mb-3 rounded-pill bg-light bg-opacity-25 text-white border border-white border-opacity-25">Global
            Content Delivery</span>
          <h1 class="display-4 fw-bold mb-3">CDN System Design</h1>
          <p class="hero-subtitle mb-4">Optimizing latency at scale: Edge Servers, Push vs Pull Caching, Anycast DNS
            Routing, and Cache Eviction Strategies.</p>
          <div class="d-flex gap-3">
            <a href="#strategies" class="btn btn-light text-warning fw-bold" style="color: #c2410c !important;">Caching
              Strategies</a>
            <a href="#routing" class="btn btn-outline-light">Anycast Routing</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="container pb-5">
    <div class="row">

      <!-- Main Content -->
      <main class="col-lg-9 order-lg-2">

        <!-- Architecture -->
        <section id="architecture" class="content-section">
          <h2>High-Level Architecture</h2>
          <p class="lead text-secondary">A CDN places <strong>Points of Presence (PoPs)</strong> geographically closer
            to users to terminate TCP connections faster and serve cached static content.</p>

          <div class="geo-diagram d-none d-md-block">
            <div class="geo-box border-primary">User (US)</div>
            <span class="arrow">‚Üî</span>
            <div class="geo-box border-warning bg-light">Edge<br>(US-East)</div>
            <br><span style="font-size: 2rem;">‚¨á ‚¨Ü</span><br>
            <div class="origin-box">Origin<br>Server</div>
            <br><span style="font-size: 2rem;">‚¨Ü ‚¨á</span><br>
            <div class="geo-box border-warning bg-light">Edge<br>(EU-West)</div>
            <span class="arrow">‚Üî</span>
            <div class="geo-box border-primary">User (EU)</div>
          </div>
        </section>

        <!-- Caching Strategies -->
        <section id="strategies" class="content-section">
          <h2>Push vs Pull Caching</h2>
          <p>How does data get to the edge?</p>

          <table class="table table-bordered comparison-table">
            <thead>
              <tr>
                <th>Strategy</th>
                <th>Concept</th>
                <th>Pros</th>
                <th>Cons</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Pull CDN (Standard)</strong></td>
                <td>Edge fetches functionality from Origin on <i>Cache Miss</i>.</td>
                <td>Low maintenance. Zero redundant storage.</td>
                <td>First user suffers high latency ("Cold Start").</td>
              </tr>
              <tr>
                <td><strong>Push CDN</strong></td>
                <td>Engineer manually uploads content to CDN.</td>
                <td>Content is always close to user.</td>
                <td>High maintenance. Complex invalidation.</td>
              </tr>
            </tbody>
          </table>
        </section>

        <!-- Routing -->
        <section id="routing" class="content-section">
          <h2>Routing: Anycast vs Geo-DNS</h2>
          <p>How do we route a user to the <i>nearest</i> Edge server?</p>

          <div class="row">
            <div class="col-md-6 mb-3">
              <div class="tech-card">
                <h5 class="fw-bold">üåç Geo-DNS</h5>
                <p class="small text-muted">DNS server checks Client IP -> Looks up Geo Database -> Returns IP of
                  nearest server.</p>
                <span class="badge bg-secondary">Slow (DNS Caching issues)</span>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="tech-card">
                <h5 class="fw-bold">üì° Anycast DNS</h5>
                <p class="small text-muted">All Edge servers share the <strong>Same IP Address</strong>. BGP routing
                  automatically sends packets to the topological nearest node.</p>
                <span class="badge bg-success">Fast & Resilient</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Eviction Policies -->
        <section id="eviction" class="content-section">
          <h2>Cache Eviction Policies</h2>
          <p>Edge storage is finite. What do we delete when it's full?</p>
          <ul>
            <li><strong>LRU (Least Recently Used):</strong> Discard items not accessed for the longest time. (Standard).
            </li>
            <li><strong>LFU (Least Frequently Used):</strong> Discard items with lowest total hit count. (Good for
              stable popularity).</li>
            <li><strong>TTL (Time To Live):</strong> Expire content based on `Cache-Control` header max-age.</li>
          </ul>
        </section>

        <!-- Configuration Example -->
        <section id="code" class="content-section">
          <h2>Nginx Proxy Cache Example</h2>
          <p>Configuring a simple "Pull" CDN node using Nginx.</p>

          <pre><code class="language-nginx">proxy_cache_path /data/nginx/cache keys_zone=mycache:10m;

server {
    listen 80;
    
    location / {
        # 1. Forward to Origin if miss
        proxy_pass http://origin_server;
        
        # 2. Store response in cache zone
        proxy_cache mycache;
        
        # 3. Cache valid rules
        proxy_cache_valid 200 302 60m; # Cache SUCCESS for 60 mins
        proxy_cache_valid 404 1m;      # Cache Not Found briefly
        
        # 4. Add header for debugging status (HIT/MISS)
        add_header X-Cache-Status $upstream_cache_status;
    }
}</code></pre>
        </section>

        <section class="content-section border-top pt-5">
          <h2>Summary</h2>
          <ul>
            <li><strong>Reduce Latency:</strong> Terminate SSL/TCP closer to the user to reduce Round Trip Time (RTT).
            </li>
            <li><strong>Pull Caching:</strong> Most common. Fetch on demand.</li>
            <li><strong>Anycast:</strong> Use BGP for network-level routing to nearest PoP.</li>
            <li><strong>Tiered Caching:</strong> Edge -> Regional -> Origin. Protects Origin from "Thundering Herd".
            </li>
          </ul>
        </section>

      </main>

      <!-- Sidebar -->
      <aside class="col-lg-3 order-lg-1 mb-4">
        <div class="sidebar-sticky">
          <h6 class="fw-bold text-uppercase text-secondary mb-3 small tracking-wide">On this page</h6>
          <nav class="nav flex-column sidebar-toc">
            <a class="nav-link" href="#architecture">Architecture</a>
            <a class="nav-link" href="#strategies">Push vs Pull</a>
            <a class="nav-link" href="#routing">Anycast Routing</a>
            <a class="nav-link" href="#eviction">Eviction Policies</a>
            <a class="nav-link" href="#code">Nginx Config</a>
          </nav>

          <hr class="my-4">
          <h6 class="fw-bold text-secondary mb-3 small">Related Topics</h6>
          <ul class="list-unstyled small">
            <li class="mb-2"><a href="../caching-layer/" class="text-decoration-none text-muted">Caching Strategies</a>
            </li>
            <li class="mb-2"><a href="../load-balancing/" class="text-decoration-none text-muted">Load Balancing</a>
            </li>
            <li class="mb-2"><a href="../cloud-storage-system-design/" class="text-decoration-none text-muted">Cloud
                Storage (S3)</a></li>
          </ul>
        </div>
      </aside>

    </div>
  </div>

  <footer loadhtml="https://brijesh.work/pub/inc/footer.html"></footer>
  <script src="https://brijesh.work/pub/js/footer.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-nginx.min.js"></script>
  <script>includeHTML();</script>
</body>

</html>